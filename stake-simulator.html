<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ZUZUCOIN — Stake Simulator</title>
<meta name="theme-color" content="#0e1522">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="style.css">

<style>
/* Sayfaya küçük ek düzenlemeler (mevcut style.css ile uyumlu) */
.sim-grid{display:grid;grid-template-columns:1.1fr .9fr;gap:18px}
@media(max-width:980px){.sim-grid{grid-template-columns:1fr}}
.form-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
@media(max-width:760px){.form-grid{grid-template-columns:1fr}}
.hint{color:#9ab0da;font-size:.95rem}
.kpis{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-top:10px}
@media(max-width:980px){.kpis{grid-template-columns:1fr 1fr}}
@media(max-width:540px){.kpis{grid-template-columns:1fr}}
.kpi{background:#0f1a30;border:1px solid #22365a;border-radius:14px;padding:12px}
.kpi .t{color:#90a9d6;font-size:.9rem}
.kpi .v{font-weight:800;font-size:1.15rem;margin-top:4px}
.chart-box{background:#0f1a30;border:1px solid #22365a;border-radius:14px;padding:10px}
label small{color:#89a2cd}
.switch{display:flex;gap:8px;align-items:center}
.switch input{accent-color:#7f9cff}
.table-wrap{overflow-x:auto}
table.proj{width:100%;border-collapse:collapse}
table.proj th,table.proj td{padding:8px;border-bottom:1px solid #22365a;text-align:left}
table.proj th{color:#9fb7ff}
.note{color:#9ab0da;margin-top:8px}
.badge2{display:inline-block;background:#182745;border:1px solid #2a3f66;border-radius:999px;padding:.25rem .6rem;color:#a8c2ff;font-size:.85rem}
</style>
</head>
<body>

<header class="z-nav">
  <div class="z-container z-nav-inner">
    <a class="brand" href="index.html">
      <img src="assets/images/logo.png" alt="ZUZU"><span>ZUZUCOIN</span>
    </a>
    <nav class="z-menu">
      <a href="index.html#presale">Pre-Sale</a>
      <a href="index.html#stake">Stake</a>
      <a href="index.html#nft">NFT</a>
      <a href="index.html#tokenomics">Tokenomics</a>
      <a href="claim.html">Claim</a>
      <button id="connectBtn" class="z-btn z-btn-primary">Connect MetaMask</button>
    </nav>
  </div>
</header>

<main>
  <section class="z-section hero">
    <div class="z-container">
      <div class="badge">Analyzer</div>
      <h1>Stake Simulator</h1>
      <p class="lead">
        ZUZU stake getirini <b>kilit süresi</b>, <b>baz APY</b>, <b>NFT BOOST</b> ve <b>Early Badge</b> senaryoları ile simüle et.
        İster basit getiri, ister aylık bileşik hesabı kullan.
      </p>
      <div class="z-chip-row">
        <span class="z-chip">Supported lock tiers: 30 / 90 / 180 / 365 / 540 days</span>
        <span class="z-chip">Base APY: 12% ~ 85% (tier’a göre)</span>
      </div>
    </div>
  </section>

  <section class="z-section">
    <div class="z-container sim-grid">
      <!-- LEFT: Form -->
      <div class="card">
        <h3>Parameters</h3>
        <div class="form-grid">
          <div>
            <label>Amount (ZUZU) <small>e.g., 10,000</small></label>
            <input id="inAmount" class="input" placeholder="e.g., 10,000" inputmode="decimal">
          </div>
          <div>
            <label>Lock Period</label>
            <select id="inLock" class="input">
              <option value="30">30 days (12% APY)</option>
              <option value="90">90 days (24% APY)</option>
              <option value="180">180 days (40% APY)</option>
              <option value="365">365 days (65% APY)</option>
              <option value="540">540 days (85% APY)</option>
            </select>
          </div>
          <div>
            <label>Have NFT? <small>adds bonus</small></label>
            <select id="inNft" class="input">
              <option value="0">No</option>
              <option value="5">ZUZU Hero (+5%)</option>
              <option value="8">ZUZU Rogue (+8%)</option>
              <option value="10">ZUZU Berserker (+10%)</option>
              <option value="6">ZUZU Hacker (+6%)</option>
              <option value="9">ZUZU Sorceress (+9%)</option>
              <option value="7">ZUZU Warrior (+7%)</option>
              <option value="5">ZUZU Maiden (+5%)</option>
              <option value="9">ZUZU Scientist (+9%)</option>
              <option value="12">ZUZU Titan (+12%)</option>
            </select>
          </div>
          <div>
            <label>Early Badge</label>
            <select id="inEarly" class="input">
              <option value="0">None</option>
              <option value="3">Badge +3%</option>
              <option value="5">Badge+ +5%</option>
            </select>
          </div>
          <div class="switch">
            <input id="inCompound" type="checkbox">
            <label for="inCompound">Monthly compounding</label>
          </div>
          <div>
            <button id="calcBtn" class="z-btn z-btn-primary" style="width:100%">Calculate</button>
          </div>
        </div>

        <p class="hint">
          Not: Hesaplar simülasyondur. Gerçek dağıtımlar stake sözleşmesinin kurallarına, havuz durumuna ve kampanya dönemlerine göre farklılık gösterebilir.
        </p>

        <div class="kpis">
          <div class="kpi">
            <div class="t">Total Return</div>
            <div id="outTotal" class="v">0 ZUZU</div>
          </div>
          <div class="kpi">
            <div class="t">Monthly Avg</div>
            <div id="outMonthly" class="v">0 ZUZU</div>
          </div>
          <div class="kpi">
            <div class="t">Total Boost</div>
            <div id="outBoost" class="v">+0%</div>
          </div>
          <div class="kpi">
            <div class="t">Effective APR</div>
            <div id="outAPR" class="v">0%</div>
          </div>
        </div>
      </div>

      <!-- RIGHT: Chart -->
      <div class="card">
        <h3>Projection</h3>
        <div class="chart-box">
          <canvas id="chart" width="780" height="340"></canvas>
        </div>
        <p class="note">Grafik: Aylık bakiye (bileşik seçiliyse bileşiklenmiş) ve toplam proje edilmiş kazanç eğrisi.</p>
      </div>
    </div>

    <div class="z-container" style="margin-top:14px">
      <div class="card">
        <div class="section-head">
          <h3>Monthly Breakdown</h3>
          <p>İlk 18 aya kadar özet tablo.</p>
        </div>
        <div class="table-wrap">
          <table class="proj">
            <thead>
              <tr>
                <th>Month</th>
                <th>Start Balance</th>
                <th>Yield</th>
                <th>End Balance</th>
              </tr>
            </thead>
            <tbody id="rows"></tbody>
          </table>
        </div>
        <div class="note">
          <span class="badge2">Tip</span> — “Monthly compounding” aktifken, her ayın getirisi anaparaya eklenir ve bir sonraki aya daha yüksek bakiye ile girersiniz.
        </div>
      </div>
    </div>
  </section>
</main>

<footer class="z-footer">
  <div class="z-container between center-v">
    <small>© ZUZUCOIN 2025</small>
    <div class="z-chip-row">
      <a class="z-chip" href="index.html#presale">Pre-Sale</a>
      <a class="z-chip" href="index.html#stake">Stake</a>
      <a class="z-chip" href="index.html#nft">NFT</a>
      <a class="z-chip" href="index.html#tokenomics">Tokenomics</a>
    </div>
  </div>
</footer>

<script>
/* ===== MetaMask connect (opsiyonel) ===== */
const btn = document.getElementById("connectBtn");
btn.addEventListener("click", async ()=>{
  if(!window.ethereum){ alert("MetaMask not detected."); return; }
  try{
    await window.ethereum.request({method:"eth_requestAccounts"});
    btn.textContent = "MetaMask ✓";
  }catch(e){ alert("Wallet connect rejected."); }
});

/* ===== Stake Simulator Logic ===== */
const APY = {30:12, 90:24, 180:40, 365:65, 540:85};

const el = {
  amount: document.getElementById("inAmount"),
  lock: document.getElementById("inLock"),
  nft: document.getElementById("inNft"),
  early: document.getElementById("inEarly"),
  comp: document.getElementById("inCompound"),
  calc: document.getElementById("calcBtn"),
  total: document.getElementById("outTotal"),
  monthly: document.getElementById("outMonthly"),
  boost: document.getElementById("outBoost"),
  apr: document.getElementById("outAPR"),
  chart: document.getElementById("chart"),
  rows: document.getElementById("rows")
};

function parseNum(v){ return parseFloat((v||"").toString().replace(/[^\d.]/g,"")) || 0; }

function calc(){
  const a = parseNum(el.amount.value);
  const d = parseInt(el.lock.value,10);
  const base = APY[d] || 0;
  const bN = parseFloat(el.nft.value||"0");
  const bE = parseFloat(el.early.value||"0");
  const totalBoost = bN + bE;
  const comp = !!el.comp.checked;

  // Yıllık oran:
  const apr = base + totalBoost; // basit varsayım
  // Periyot (gün) => ay adedi:
  const months = Math.max(1, Math.round(d/30));
  const monthlyRate = apr/12/100;

  let balance = a;
  let sumYield = 0;
  const points = []; // chart için
  const rows = [];

  for(let m=1; m<=Math.min(18, months); m++){
    const start = balance;
    const y = start * monthlyRate;
    sumYield += y;
    const end = comp ? (start + y) : (start);
    if(comp) balance = end; // bileşik ise ekle
    points.push({m, val: end});
    rows.push({m, start, y, end});
  }

  // Dönem toplam getiri (lineer: d/365)
  const linearGross = a * (apr/100) * (d/365);
  const totalReturn = comp ? (balance - a) : linearGross;
  const monthlyAvg = totalReturn / months;

  el.total.textContent = totalReturn.toFixed(2) + " ZUZU";
  el.monthly.textContent = monthlyAvg.toFixed(2) + " ZUZU";
  el.boost.textContent = "+" + totalBoost + "%";
  el.apr.textContent = apr.toFixed(2) + "%";

  renderChart(points, a, comp);
  renderRows(rows);
}

function renderRows(rows){
  const fmt = n => (n||0).toLocaleString(undefined,{maximumFractionDigits:2});
  el.rows.innerHTML = rows.map(r=>`
    <tr>
      <td>${r.m}</td>
      <td>${fmt(r.start)}</td>
      <td>${fmt(r.y)}</td>
      <td>${fmt(r.end)}</td>
    </tr>
  `).join("") || `<tr><td colspan="4" style="color:#9fb4dd">No data.</td></tr>`;
}

function renderChart(points, base, comp){
  const c = el.chart, ctx = c.getContext("2d");
  const W = c.width, H = c.height;
  ctx.clearRect(0,0,W,H);

  // Axis
  ctx.fillStyle = "#0e1522";
  ctx.fillRect(0,0,W,H);
  // frame
  ctx.strokeStyle="#23365d"; ctx.lineWidth=1;
  ctx.strokeRect(38,16,W-54,H-40);

  if(!points.length){ return; }

  const maxVal = Math.max(...points.map(p=>p.val), base);
  const minVal = Math.min(base, ...points.map(p=>p.val));
  const padL=48, padR=16, padT=20, padB=28;
  const chartW = W - padL - padR, chartH = H - padT - padB;

  function x(i){ return padL + (i/(points.length-1||1))*chartW; }
  function y(v){
    const ratio = (v - minVal) / (maxVal - minVal || 1);
    return padT + (1-ratio)*chartH;
  }

  // grid lines
  ctx.strokeStyle="rgba(255,255,255,.06)";
  ctx.lineWidth=1;
  ctx.beginPath();
  for(let i=0;i<5;i++){
    const yy = padT + (i/4)*chartH;
    ctx.moveTo(padL, yy); ctx.lineTo(padL+chartW, yy);
  }
  ctx.stroke();

  // baseline (start)
  ctx.strokeStyle="#2f436e";
  ctx.setLineDash([4,4]);
  ctx.beginPath();
  const yBase = y(base);
  ctx.moveTo(padL, yBase); ctx.lineTo(padL+chartW, yBase);
  ctx.stroke();
  ctx.setLineDash([]);

  // line
  ctx.strokeStyle = comp ? "#8bd1ff" : "#9ad77c";
  ctx.lineWidth = 2.4;
  ctx.beginPath();
  points.forEach((p,i)=>{
    const xx = x(i), yy = y(p.val);
    if(i===0) ctx.moveTo(xx,yy); else ctx.lineTo(xx,yy);
  });
  ctx.stroke();

  // points
  ctx.fillStyle = "rgba(255,255,255,.8)";
  points.forEach((p,i)=>{
    const xx = x(i), yy = y(p.val);
    ctx.beginPath(); ctx.arc(xx,yy,2.6,0,Math.PI*2); ctx.fill();
  });

  // labels
  ctx.fillStyle="#9fb4dd";
  ctx.font="700 12px Inter, system-ui";
  ctx.textAlign="left";
  ctx.fillText("Start", padL+6, yBase-6);
  ctx.textAlign="right";
  ctx.fillText("Months", padL+chartW, H-8);
}

document.getElementById("calcBtn").addEventListener("click", calc);
// ilk hesap
calc();
</script>
</body>
</html>
