<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ZUZU — Claim Portal (Solana)</title>
<meta name="theme-color" content="#0e1522">
<link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="style.css">
</head>
<body>
<header class="z-nav">
  <div class="z-container z-nav-inner">
    <a class="brand" href="index.html">
      <img src="assets/images/logo.png" alt="ZUZU"><span>ZUZUCOIN</span>
    </a>
    <nav class="z-menu">
      <a href="index.html#presale">Pre-Sale</a>
      <a href="index.html#stake">Stake</a>
      <a href="index.html#nft">NFT</a>
      <a href="index.html#tokenomics">Tokenomics</a>
      <a href="stake-simulator.html" class="z-chip">Stake Simulator</a>
      <button id="connectBtn" class="z-btn z-btn-primary" data-connect>Connect Wallet</button>
    </nav>
  </div>
</header>

<main class="z-section">
  <div class="z-container">
    <div class="section-head">
      <h1>Claim Portal</h1>
      <p>Pre-sale sırasında yaptığınız alımlar, <b>bu Solana cüzdan adresi</b> ile eşleştirilir. TGE açıldığında, birikmiş hak edişinizi buradan talep edebileceksiniz.</p>
      <div class="z-chip-row">
        <span class="z-chip">Network: <b>Solana (mainnet-beta)</b></span>
        <span class="z-chip">Payment token: <b>USDT (SPL)</b></span>
        <span class="z-chip">Your Wallet: <code id="claimPk">—</code></span>
      </div>
    </div>

    <div class="card">
      <h3>Purchases Linked To Your Wallet</h3>
      <p>Bu tabloda, bu tarayıcıda kayıtlı alımlar görünür. Farklı cihazdan aldıysanız, aşağıdaki formdan makbuz ekleyin.</p>
      <div id="claimTable" class="statwrap" style="grid-template-columns:1fr;">
        <div class="stat">
          <div class="label">No local records yet.</div>
          <div class="value">—</div>
        </div>
      </div>
    </div>

    <div class="card">
      <h3>Add a Receipt (manual)</h3>
      <div class="calc-grid" style="grid-template-columns:1fr 1fr;">
        <div>
          <label>USDT Amount (SPL)</label>
          <input class="input" id="rcptAmount" placeholder="e.g., 250.50">
        </div>
        <div>
          <label>Week / Unit Price (optional)</label>
          <input class="input" id="rcptNote" placeholder="Week 1 @0.0050">
        </div>
        <div style="grid-column:1 / -1">
          <label>TX Hash (Solana)</label>
          <input class="input" id="rcptTx" placeholder="5Yd... (signature)">
        </div>
      </div>
      <div style="margin-top:10px;display:flex;gap:10px">
        <button id="addRcpt" class="z-btn z-btn-primary">Add Receipt</button>
        <button id="clearRcpt" class="z-btn z-btn-ghost">Clear My Local Records</button>
      </div>
      <p class="muted" style="margin-top:8px">Not: Bu kayıtlar yalnızca yerel cihazınızda tutulur ve ön talep hesaplamaları içindir.</p>
    </div>
  </div>
</main>

<script>
  const TBL_KEY = "zuzu_claim_rcpts";
  const $ = s => document.querySelector(s);

  function pkLabel(){
    try{
      const pk = localStorage.getItem("zuzu_connected_addr") || "";
      $("#claimPk").textContent = pk ? pk.slice(0,6)+"..."+pk.slice(-6) : "—";
    }catch{ $("#claimPk").textContent = "—"; }
  }

  function loadRcpts(){ try{ return JSON.parse(localStorage.getItem(TBL_KEY)||"[]"); }catch{ return []; } }
  function saveRcpts(arr){ try{ localStorage.setItem(TBL_KEY, JSON.stringify(arr||[])); }catch{} }

  function renderTable(){
    const wrap = $("#claimTable");
    const rows = loadRcpts();
    if (!rows.length){
      wrap.innerHTML = `<div class="stat"><div class="label">No local records yet.</div><div class="value">—</div></div>`;
      return;
    }
    wrap.innerHTML = rows.map(r=>`
      <div class="stat">
        <div class="label">USDT: <b>${r.amount}</b> • Note: ${r.note||"-"}</div>
        <div class="value"><a href="https://solscan.io/tx/${r.tx}" target="_blank" rel="noopener">${r.tx.slice(0,8)}...${r.tx.slice(-8)}</a></div>
      </div>`).join("");
  }

  window.addEventListener("DOMContentLoaded", ()=>{
    pkLabel(); renderTable();

    $("#addRcpt").addEventListener("click", ()=>{
      const amount = parseFloat($("#rcptAmount").value||"0");
      const tx = ($("#rcptTx").value||"").trim();
      const note = ($("#rcptNote").value||"").trim();
      if (!amount || !tx) { alert("Please fill USDT amount and TX hash."); return; }
      const list = loadRcpts(); list.push({amount, tx, note, t: Date.now()}); saveRcpts(list);
      $("#rcptAmount").value = ""; $("#rcptTx").value = ""; $("#rcptNote").value = "";
      renderTable();
    });

    $("#clearRcpt").addEventListener("click", ()=>{
      if (confirm("Clear all local receipts?")) { saveRcpts([]); renderTable(); }
    });
  });

  ["visibilitychange","pageshow"].forEach(ev=>{
    document.addEventListener(ev, ()=>{ if(ev!=="visibilitychange"||!document.hidden) pkLabel(); });
  });
</script>

<!-- Solana web3 (CDN) ve ortak script -->
<script src="https://unpkg.com/@solana/web3.js@1.95.3/lib/index.iife.min.js"></script>
<script src="script.js"></script>
</body>
</html>
